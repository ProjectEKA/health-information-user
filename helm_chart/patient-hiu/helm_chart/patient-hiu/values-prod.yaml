# Default values for hiu.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

rollingUpdate:
  maxSurge: 50%
  maxUnavailable: 0

replicaCount: 5
autoscaling:
  enabled: true
  minReplicas: 5
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 60
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 90

image:
  repository: "nha20/jas-health-information-user"
  tag: "7176637"
  pullPolicy: IfNotPresent

imagePullSecrets:
  - name: ndhm-dockerhub-repo

nameOverride: "patient-hiu"
fullnameOverride: "patient-hiu"
fullname: "patient-hiu"

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name:

podSecurityContext: {}
  # fsGroup: 2000

## Persist data to a persistent volume

persistence:
  enabled: true
  existingClaim: ""
  storageClass: "gluster"
  mountPath: "/mnt/patient-hiu-data"
  VolumeName: "patient-hiu-data-prod"
  accessMode: ReadWriteMany
  size: 500Gi

pv:
  enabled: false

livenessProbe:
  enabled: true
  initialDelaySeconds: 30
  periodSeconds: 60
  timeoutSeconds: 1
  failureThreshold: 10
readinessProbe:
  enabled: true
  initialDelaySeconds: 10
  periodSeconds: 60
  timeoutSeconds: 1
  failureThreshold: 10

service:
  type: ClusterIP
  port: 8003

ingress:
  enabled: true
  hosts:
    - live.ndhm.gov.in
  gateway: nha-gw.nha-prod-gw
  uriPrefix: "/api-hiu/"
  rewriteUri: "/"

authpolicy:
  enabled: true
  policy: '["/api-hiu/internal/*"]'

resources:
  limits:
    cpu: "1000m"
    memory: "2048Mi"
  requests:
    cpu: "1000m"
    memory: "2048Mi"

nodeSelector: {}

tolerations: []

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: affinity
              operator: In
              values:
                - cm

env:
  normal: 
    CENTRAL_REGISTRY_JWK_URL: http://client-registry:8080/certs
    CENTRAL_REGISTRY_URL: http://client-registry:8080
    CONSENT_MANAGEMENT_SUFFIX: '@ndhm'
    CONSENT_MANAGEMENT_URL: http://consent-manager:8000
    CONSENT_NOTIFICATION_URL: http://patient-hiu:8003/consent/notification
    CONSENT_MANAGER_DB_NAME: patient_health_information_user
    DATA_PUSH_URL: http://patient-hiu:8003/data/notification
    DB_CONNECTION_POOL_SIZE: "5"
    DEFAULT_PAGE_SIZE: "20"
    GATEWAY_BASE_URL: 'http://gateway.nha-gw.svc.cluster.local:8000/v0.5'
    GATEWAY_REQUEST_TIMEOUT: "8000"
    HIU_NAME: Max Health Care
    LOCAL_STORAGE_PATH: /mnt/patient-hiu-data/
    MAX_IN_MEMORY_SIZE: 500MB
    MAX_PAGE_SIZE: "100"
    OFFSET_IN_DAYS: "2"
    GATEWAY_JWK_URL: 'http://gateway.nha-gw.svc.cluster.local:8000/v0.5/certs'
    HIU_CLIENT_ID: "10000009"
    HIU_ID: "10000009"
    ORTHANC_SERVER_URL: http://orthanc:8042
    ORTHANC_USERNAME: orthanc
    POSTGRES_HOST: postgres-prd3-postgres-3.nhadclprdmgm.tatacommunications.com
    POSTGRES_PORT: "5003"
    POSTGRES_USER: "postgres"
    USING_GATEWAY: "true"
    RABBITMQ_HOST: "rabbitmqtcp-prd1-ndhm-mqaas-1.nhadclprdmgm.tatacommunications.com"
    RABBITMQ_PORT: "5004"
    RABBITMQ_USERNAME: "admin"
    IDENTITY_JWK_URL: "http://keycloak:8080/auth/realms/consent-manager/protocol/openid-connect/certs"
    DATA_FLOW_CONSENT_REQUEST_WAIT_TIME: "2000"
    DATA_FLOW_CONSENT_ARTEFACT_WAIT_TIME: "2000"
    DATA_FLOW_PART_WAIT_TIME: "2000"
    RABBITMQ_PREFIX: patient-hiu
    LOGIN_METHOD: both
    Account_Service_Url: https://healthid.ndhm.gov.in/api
    REDIS_HOST: redis-prd1-redis-prod-1.nhadclprdmgm.tatacommunications.com
    REDIS_PORT: "5006"
    CACHE_METHOD: redis
    AUTHORIZATION_HEADER: "X-AUTH-TOKEN"
    MAXIMUM_CONSENT_REQUEST_DELAY_IN_MINUTES: 2
    REDIS_RETRY: 1
    HAS_BEHIND_GATEWAY: "true"
    KEEP_ALIVE_ENABLED: "true"
    HAS_CLIENT_ID: "10000009"
    HAS_AUTH_URL: https://live.ndhm.gov.in/gateway/v0.5
    LOG_LEVEL: "INFO"
    USE_HTTP_CONNECTION_POOL: "true"
    HTTP_CONNECTION_POOL_SIZE: 500
    HTTP_CONNECTION_MAX_LIFETIME: 10
    HTTP_CONNECTION_MAX_IDLETIME: 5
    DISABLE_HTTP_OPTIONS: "true"
  secrets:
    HIU_CLIENT_SECRET: ""
    ORTHANC_PASSWORD: ""
    POSTGRES_PASSWORD: ""
    RABBITMQ_PASSWORD: ""
    REDIS_PASSWORD: ""
    HAS_CLIENT_SECRET: ""
