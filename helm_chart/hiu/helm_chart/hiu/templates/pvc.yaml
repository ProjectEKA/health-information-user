{{ if .Values.pv.enabled -}}
apiVersion: v1
kind: PersistentVolume
metadata:
 name: "{{ .Values.pv.VolumeName }}"
 labels:
   app.kubernetes.io/instance: {{ .Release.Name }}
   app.kubernetes.io/managed-by: {{ .Release.Service }}
   type: {{ .Values.pv.storageClass }}
spec:
 storageClassName: {{ .Values.pv.storageClass }}
 capacity:
   storage: {{ .Values.pv.size | quote }}
 accessModes:
   - {{ .Values.pv.accessMode | quote }}
 persistentVolumeReclaimPolicy: Retain
{{ end -}}
---
{{ if .Values.persistence.enabled -}}
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ .Values.persistence.VolumeName }}
spec:
  storageClassName: "{{ .Values.persistence.storageClass }}"
  accessModes:
   - {{ .Values.persistence.accessMode | quote }}
  resources:
    requests:
      storage: {{ .Values.persistence.size | quote }}
{{ end -}}